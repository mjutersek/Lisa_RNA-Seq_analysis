---
title: "Salmon RNA-Seq"
author: "Mojca Juter≈°ek"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_caption: yes
    self_contained: yes
    fig_width: 12
    fig_height: 9
    toc: yes
    toc_depth: 2
    toc_float: true
    number_sections: yes
    theme: flatly
    highlight: tango
  pdf_document:
    toc: yes
    toc_depth: '2'
  word_document:
    toc: yes
    toc_depth: '2'
editor_options:
  chunk_output_type: inline
---

```{r}
fp <- file.path("..", "..", "03_Pseudoalignment_Salmon", "output")
paths <- list.dirs(fp,full.names = TRUE, recursive = FALSE)
paths <- paste0(paths, "/")
raw <- edgeR::catchSalmon(paths)
```

```{r}
colnames(raw$counts) <- basename(colnames(raw$counts))
counts <- as.data.frame(raw$counts)
scaled_counts <- as.data.frame(raw$counts/raw$annotation$Overdispersion)

colnames(scaled_counts) <- sub("^(([^_]+)_([^_]+)_([^_]+))_.*", "\\1", colnames(scaled_counts))
```
